_format_version: "3.0"
_transform: true

services:
  - name: profile-service
    url: http://profile:3030
    routes:
      - name: profile-route
        paths:
          - /profile

  - name: project-service
    url: http://project:3040
    routes:
      - name: project-route
        paths:
          - /project
  
  - name: task-service
    url: http://task:3031
    routes:
      - name: task-route
        paths:
          - /task

  - name: manage-account-service
    url: http://manage-account:8090
    routes:
      - name: manage-account-route
        paths:
          - /manage-account

  - name: manage-task-service
    url: http://manage-task:8091
    routes:
      - name: manage-task-route
        paths:
          - /manage-task

  - name: organise-project-service
    url: http://organise-project:8092
    routes:
      - name: organise-project-route
        paths:
          - /organise-project

plugins:
  - name: rate-limiting
    config:
      minute: 100
      policy: local

  - name: cors
    config:
      origins:
        - "*"
      methods:
        - HEAD
        - GET
        - POST
        - PUT
        - PATCH
        - DELETE
        - OPTIONS
      headers:
        - Access-Control-Allow-Origin
        - Accept
        - Accept-Version
        - Content-Length
        - Content-MD5
        - Content-Type
        # - Authorization # Maybe remove this

  - name: prometheus
    enabled: true
    protocols:
      - grpc
      - grpcs
      - http
      - https
    config:
      ai_metrics: false
      bandwidth_metrics: false
      latency_metrics: false
      per_consumer: false
      status_code_metrics: false
      upstream_health_metrics: false
